{% load custom_tags %}
{% load static %}
<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

  <link rel="stylesheet" href="{% static 'index.css' %}">

  <title>Piranhad</title>
</head>

<body>
  {% include 'app/navbar.html' %}
  <div class="container-fluid count1">
    <div class="d-flex align-items-center mb-3" >
      <i class="bi bi-house "></i>
      <p class="firstpara mb-0" style="margin-left: .7rem;" > /Campaigns</p>
    </div>
    <p class="firstpara">Step #1: Create Screenshot Campaign Name</p>
    <form method="post" action="/create_campaign" class="d-flex formcont">
      {% csrf_token %}
      <input class="form-control inputcontrol me-2" type="search" name="Name" placeholder="Campaign name" aria-label="Search" required>
      <button class="btn btntwo" type="submit">Create Campaign</button>
    </form>
    {{errors.Name}}
    {% if messages %}
    {% for i in messages %}
    <p style="color: red; float:right">{{i}}</p>
    {% endfor %}
    {% endif %}
    <div class="table-responsive-sm tablediv bg-white">
      <p class="firstpara"><i>**Note: Campaign will be deleted automatically after 30 days**</i></p>
      <table class="table">
        <tbody>
          <tr>
            <th scope="col">Name</th>
            <th scope="col">Screenshots</th>
            <th scope="col">Date/Time</th>
            <th scope="col">View</th>
            <th scope="col">Delete</th>
            <th scope="col">Logs</th>
          </tr>
          {% for i in qs %}
          {% if i.completed %}
          <tr>
            <td scope="row" class="td1">{{i.Name}}</td>
            <td class="tdothers">{{i.id|screenshot}}</td>
            <td class="tdothers">{{i.create_at}}</td>
            <td class="tdothers"><a style="text-decoration: none;" href="/view_screenshots/{{i.pk}}/" class="tdlast">View</a></td>
            <td class="tdothers"><a style="text-decoration: none;" href="/delete_screenshots/{{i.pk}}/" class="tdlast">Delete</a></td>
            <td class="tdothers"><div style="max-height: 10rem; overflow-y:auto" >{% for j in i.errors reversed %}<div>- {{j}}</div>{% endfor %}</div></td>
          </tr>
          {% else %}
          <script>
            var status=true;
            console.log('else',status);
          </script>
          <tr>
          <td scope="row" class="td1">{{i.Name}}</td>
          <td class="tdothers">{{i.id|screenshot}}</td>
          <td class="tdothers">{{i.create_at}}</td>
          <td class="tdothers">Campaign in Progress...</td>
          <td class="tdothers"></td>
          <td class="tdothers">{% for j in i.errors reversed %}<div>- {{j}}</div>{% endfor %}</td>
          </tr>
          {% endif %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% include 'app/footerAdmin.html' %}
  <!-- <div class="lastpart">All rights reserved 2022 by <a href="index">Piranhad</a>. Developed and maintained by <a href="https://fabtechsol.com/">Fabulous Technology Solutions</a>.</div> -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
    <script>
      if (status) {
        let myInterval = setInterval(()=> {
          console.log(status);
          location.reload();
        }, 10000);
        myInterval();
      }
      // clearInterval(myInterval);
    </script>
</body>

</html>